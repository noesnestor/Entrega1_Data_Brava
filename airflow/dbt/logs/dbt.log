2022-02-21 23:57:39.324651 (MainThread): Running with dbt=0.21.1
2022-02-21 23:57:40.085247 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/opt/airflow/dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-02-21 23:57:40.103626 (MainThread): Tracking: tracking
2022-02-21 23:57:40.159482 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b199add0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b60e4450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b19a5e90>]}
2022-02-21 23:57:40.237583 (MainThread): Partial parsing not enabled
2022-02-21 23:57:40.358697 (MainThread): Parsing macros/relations.sql
2022-02-21 23:57:40.372972 (MainThread): Parsing macros/catalog.sql
2022-02-21 23:57:40.385852 (MainThread): Parsing macros/adapters.sql
2022-02-21 23:57:40.546109 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-02-21 23:57:40.643303 (MainThread): Parsing macros/core.sql
2022-02-21 23:57:40.680718 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-21 23:57:40.696402 (MainThread): Parsing macros/etc/datetime.sql
2022-02-21 23:57:40.856683 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-21 23:57:40.871404 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-21 23:57:40.880214 (MainThread): Parsing macros/etc/query.sql
2022-02-21 23:57:40.893727 (MainThread): Parsing macros/etc/where_subquery.sql
2022-02-21 23:57:40.911846 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-21 23:57:40.931390 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-21 23:57:41.004281 (MainThread): Parsing macros/materializations/test.sql
2022-02-21 23:57:41.030307 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-21 23:57:41.172033 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-21 23:57:41.241272 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-21 23:57:41.245968 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-21 23:57:41.255584 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-21 23:57:41.270501 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-21 23:57:41.305522 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-21 23:57:41.310462 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-02-21 23:57:41.356499 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-21 23:57:41.378172 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-21 23:57:41.425992 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-21 23:57:41.441374 (MainThread): Parsing macros/adapters/common.sql
2022-02-21 23:57:41.560553 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-21 23:57:41.681480 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-21 23:57:41.693153 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-21 23:57:41.707112 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-21 23:57:42.141394 (MainThread): Acquiring new postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-21 23:57:42.254660 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '373a21c0-633b-41a4-a96b-18fdba23daa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b187ae10>]}
2022-02-21 23:57:42.279970 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-02-21 23:57:42.283095 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '373a21c0-633b-41a4-a96b-18fdba23daa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b1805910>]}
2022-02-21 23:57:42.287864 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-02-21 23:57:42.291166 (MainThread): 
2022-02-21 23:57:42.293215 (MainThread): Acquiring new postgres connection "master".
2022-02-21 23:57:42.296057 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-02-21 23:57:42.320720 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-02-21 23:57:42.322858 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-02-21 23:57:42.325454 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-02-21 23:57:42.339830 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.01 seconds
2022-02-21 23:57:42.343278 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-02-21 23:57:42.349872 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-02-21 23:57:42.359673 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-21 23:57:42.361406 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-02-21 23:57:42.362930 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-02-21 23:57:42.374858 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-02-21 23:57:42.377317 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-21 23:57:42.379309 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-02-21 23:57:42.388193 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.01 seconds
2022-02-21 23:57:42.391407 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-02-21 23:57:42.393364 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-02-21 23:57:42.430331 (MainThread): Using postgres connection "master".
2022-02-21 23:57:42.441837 (MainThread): On master: BEGIN
2022-02-21 23:57:42.448965 (MainThread): Opening a new connection, currently in state init
2022-02-21 23:57:42.484065 (MainThread): SQL status: BEGIN in 0.04 seconds
2022-02-21 23:57:42.488991 (MainThread): Using postgres connection "master".
2022-02-21 23:57:42.498701 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-02-21 23:57:42.518387 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2022-02-21 23:57:42.521940 (MainThread): On master: ROLLBACK
2022-02-21 23:57:42.523831 (MainThread): Using postgres connection "master".
2022-02-21 23:57:42.525348 (MainThread): On master: BEGIN
2022-02-21 23:57:42.527844 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-02-21 23:57:42.529341 (MainThread): On master: COMMIT
2022-02-21 23:57:42.530845 (MainThread): Using postgres connection "master".
2022-02-21 23:57:42.532216 (MainThread): On master: COMMIT
2022-02-21 23:57:42.533777 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-21 23:57:42.535244 (MainThread): On master: Close
2022-02-21 23:57:42.539958 (MainThread): 23:57:42 | Concurrency: 1 threads (target='dw')
2022-02-21 23:57:42.541920 (MainThread): 23:57:42 | 
2022-02-21 23:57:42.558794 (Thread-1): Began running node model.reto1.staging_to_datawarehouse
2022-02-21 23:57:42.563641 (Thread-1): 23:57:42 | 1 of 1 START table model public.staging_to_datawarehouse............. [RUN]
2022-02-21 23:57:42.570880 (Thread-1): Acquiring new postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-21 23:57:42.574109 (Thread-1): Compiling model.reto1.staging_to_datawarehouse
2022-02-21 23:57:42.585563 (Thread-1): Writing injected SQL for node "model.reto1.staging_to_datawarehouse"
2022-02-21 23:57:42.603506 (Thread-1): finished collecting timing info
2022-02-21 23:57:42.669217 (Thread-1): Writing runtime SQL for node "model.reto1.staging_to_datawarehouse"
2022-02-21 23:57:42.711419 (Thread-1): Using postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-21 23:57:42.713918 (Thread-1): On model.reto1.staging_to_datawarehouse: BEGIN
2022-02-21 23:57:42.715959 (Thread-1): Opening a new connection, currently in state closed
2022-02-21 23:57:42.731932 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-02-21 23:57:42.735130 (Thread-1): Using postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-21 23:57:42.738043 (Thread-1): On model.reto1.staging_to_datawarehouse: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "node_id": "model.reto1.staging_to_datawarehouse"} */


  create  table "postgres"."public"."staging_to_datawarehouse__dbt_tmp"
  as (
    

with source_table as 
(
    select * from "postgres"."staging_schema"."users"
),

final as
(
    select * from source_table
)

select * from final
  );
2022-02-21 23:57:42.778223 (Thread-1): SQL status: SELECT 0 in 0.03 seconds
2022-02-21 23:57:42.795350 (Thread-1): Using postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-21 23:57:42.798640 (Thread-1): On model.reto1.staging_to_datawarehouse: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "node_id": "model.reto1.staging_to_datawarehouse"} */
alter table "postgres"."public"."staging_to_datawarehouse" rename to "staging_to_datawarehouse__dbt_backup"
2022-02-21 23:57:42.802448 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-02-21 23:57:42.812581 (Thread-1): Using postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-21 23:57:42.814874 (Thread-1): On model.reto1.staging_to_datawarehouse: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "node_id": "model.reto1.staging_to_datawarehouse"} */
alter table "postgres"."public"."staging_to_datawarehouse__dbt_tmp" rename to "staging_to_datawarehouse"
2022-02-21 23:57:42.820691 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-02-21 23:57:42.844499 (Thread-1): On model.reto1.staging_to_datawarehouse: COMMIT
2022-02-21 23:57:42.846755 (Thread-1): Using postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-21 23:57:42.849071 (Thread-1): On model.reto1.staging_to_datawarehouse: COMMIT
2022-02-21 23:57:42.854194 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-02-21 23:57:42.868316 (Thread-1): Using postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-21 23:57:42.871779 (Thread-1): On model.reto1.staging_to_datawarehouse: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "node_id": "model.reto1.staging_to_datawarehouse"} */
drop table if exists "postgres"."public"."staging_to_datawarehouse__dbt_backup" cascade
2022-02-21 23:57:42.882458 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2022-02-21 23:57:42.890448 (Thread-1): finished collecting timing info
2022-02-21 23:57:42.905742 (Thread-1): On model.reto1.staging_to_datawarehouse: Close
2022-02-21 23:57:42.917478 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '373a21c0-633b-41a4-a96b-18fdba23daa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b17eae90>]}
2022-02-21 23:57:42.925379 (Thread-1): 23:57:42 | 1 of 1 OK created table model public.staging_to_datawarehouse........ [SELECT 0 in 0.35s]
2022-02-21 23:57:42.927825 (Thread-1): Finished running node model.reto1.staging_to_datawarehouse
2022-02-21 23:57:42.964557 (MainThread): Acquiring new postgres connection "master".
2022-02-21 23:57:42.966754 (MainThread): Using postgres connection "master".
2022-02-21 23:57:42.968639 (MainThread): On master: BEGIN
2022-02-21 23:57:42.970299 (MainThread): Opening a new connection, currently in state closed
2022-02-21 23:57:42.983206 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-02-21 23:57:42.985076 (MainThread): On master: COMMIT
2022-02-21 23:57:42.987183 (MainThread): Using postgres connection "master".
2022-02-21 23:57:42.989181 (MainThread): On master: COMMIT
2022-02-21 23:57:42.991203 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-21 23:57:42.992787 (MainThread): On master: Close
2022-02-21 23:57:42.994834 (MainThread): 23:57:42 | 
2022-02-21 23:57:42.998258 (MainThread): 23:57:42 | Finished running 1 table model in 0.70s.
2022-02-21 23:57:43.000312 (MainThread): Connection 'master' was properly closed.
2022-02-21 23:57:43.002219 (MainThread): Connection 'list_postgres' was properly closed.
2022-02-21 23:57:43.004161 (MainThread): Connection 'model.reto1.staging_to_datawarehouse' was properly closed.
2022-02-21 23:57:43.019844 (MainThread): 
2022-02-21 23:57:43.022008 (MainThread): Completed successfully
2022-02-21 23:57:43.024165 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-02-21 23:57:43.027189 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b3a96150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b1875cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b17ec350>]}
2022-02-21 23:57:43.032135 (MainThread): Flushing usage events
2022-02-21 23:58:14.593762 (MainThread): Running with dbt=0.21.1
2022-02-21 23:58:15.018122 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/opt/airflow/dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-02-21 23:58:15.026337 (MainThread): Tracking: tracking
2022-02-21 23:58:15.075605 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ad5138d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ad515550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ad515790>]}
2022-02-21 23:58:15.144590 (MainThread): Partial parsing not enabled
2022-02-21 23:58:15.244629 (MainThread): Parsing macros/relations.sql
2022-02-21 23:58:15.258525 (MainThread): Parsing macros/catalog.sql
2022-02-21 23:58:15.310097 (MainThread): Parsing macros/adapters.sql
2022-02-21 23:58:15.605440 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-02-21 23:58:15.616727 (MainThread): Parsing macros/core.sql
2022-02-21 23:58:15.633102 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-21 23:58:15.648671 (MainThread): Parsing macros/etc/datetime.sql
2022-02-21 23:58:15.708473 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-21 23:58:15.723398 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-21 23:58:15.737348 (MainThread): Parsing macros/etc/query.sql
2022-02-21 23:58:15.749029 (MainThread): Parsing macros/etc/where_subquery.sql
2022-02-21 23:58:15.768033 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-21 23:58:15.789864 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-21 23:58:15.850440 (MainThread): Parsing macros/materializations/test.sql
2022-02-21 23:58:15.886648 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-21 23:58:16.019887 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-21 23:58:16.127619 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-21 23:58:16.136666 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-21 23:58:16.166034 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-21 23:58:16.203947 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-21 23:58:16.263596 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-21 23:58:16.280262 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-02-21 23:58:16.386688 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-21 23:58:16.422523 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-21 23:58:16.519052 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-21 23:58:16.547335 (MainThread): Parsing macros/adapters/common.sql
2022-02-21 23:58:16.870597 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-21 23:58:16.895873 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-21 23:58:16.906385 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-21 23:58:16.923658 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-21 23:58:17.646117 (MainThread): Acquiring new postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-21 23:58:17.813536 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8099821b-d448-46ef-88b2-170971e2360e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ad3cf210>]}
2022-02-21 23:58:17.835244 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-02-21 23:58:17.837832 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8099821b-d448-46ef-88b2-170971e2360e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ad3cfa10>]}
2022-02-21 23:58:17.840165 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-02-21 23:58:17.843698 (MainThread): 
2022-02-21 23:58:17.862183 (MainThread): Acquiring new postgres connection "master".
2022-02-21 23:58:17.865032 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-02-21 23:58:17.885951 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-02-21 23:58:17.887869 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-02-21 23:58:17.902768 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-02-21 23:58:17.936460 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.03 seconds
2022-02-21 23:58:17.942223 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-02-21 23:58:17.949014 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-02-21 23:58:17.969138 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-21 23:58:17.971308 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-02-21 23:58:17.976710 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-02-21 23:58:18.009521 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2022-02-21 23:58:18.012180 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-21 23:58:18.014147 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-02-21 23:58:18.019707 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2022-02-21 23:58:18.025232 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-02-21 23:58:18.028488 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-02-21 23:58:18.049709 (MainThread): Using postgres connection "master".
2022-02-21 23:58:18.052046 (MainThread): On master: BEGIN
2022-02-21 23:58:18.054512 (MainThread): Opening a new connection, currently in state init
2022-02-21 23:58:18.094153 (MainThread): SQL status: BEGIN in 0.04 seconds
2022-02-21 23:58:18.096065 (MainThread): Using postgres connection "master".
2022-02-21 23:58:18.097727 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-02-21 23:58:18.104854 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2022-02-21 23:58:18.112403 (MainThread): On master: ROLLBACK
2022-02-21 23:58:18.117460 (MainThread): Using postgres connection "master".
2022-02-21 23:58:18.119421 (MainThread): On master: BEGIN
2022-02-21 23:58:18.122543 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-02-21 23:58:18.124557 (MainThread): On master: COMMIT
2022-02-21 23:58:18.126386 (MainThread): Using postgres connection "master".
2022-02-21 23:58:18.128209 (MainThread): On master: COMMIT
2022-02-21 23:58:18.130437 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-21 23:58:18.132218 (MainThread): On master: Close
2022-02-21 23:58:18.134809 (MainThread): 23:58:18 | Concurrency: 1 threads (target='dw')
2022-02-21 23:58:18.137365 (MainThread): 23:58:18 | 
2022-02-21 23:58:18.163664 (Thread-1): Began running node model.reto1.staging_to_datawarehouse
2022-02-21 23:58:18.167511 (Thread-1): 23:58:18 | 1 of 1 START table model public.staging_to_datawarehouse............. [RUN]
2022-02-21 23:58:18.172488 (Thread-1): Acquiring new postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-21 23:58:18.176200 (Thread-1): Compiling model.reto1.staging_to_datawarehouse
2022-02-21 23:58:18.198569 (Thread-1): Writing injected SQL for node "model.reto1.staging_to_datawarehouse"
2022-02-21 23:58:18.204152 (Thread-1): finished collecting timing info
2022-02-21 23:58:18.305413 (Thread-1): Writing runtime SQL for node "model.reto1.staging_to_datawarehouse"
2022-02-21 23:58:18.313655 (Thread-1): Using postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-21 23:58:18.315740 (Thread-1): On model.reto1.staging_to_datawarehouse: BEGIN
2022-02-21 23:58:18.319096 (Thread-1): Opening a new connection, currently in state closed
2022-02-21 23:58:18.339746 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-02-21 23:58:18.352701 (Thread-1): Using postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-21 23:58:18.357246 (Thread-1): On model.reto1.staging_to_datawarehouse: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "node_id": "model.reto1.staging_to_datawarehouse"} */


  create  table "postgres"."public"."staging_to_datawarehouse__dbt_tmp"
  as (
    

with source_table as 
(
    select * from "postgres"."staging_schema"."users"
),

final as
(
    select * from source_table
)

select * from final
  );
2022-02-21 23:58:18.368301 (Thread-1): SQL status: SELECT 0 in 0.01 seconds
2022-02-21 23:58:18.383692 (Thread-1): Using postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-21 23:58:18.385593 (Thread-1): On model.reto1.staging_to_datawarehouse: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "node_id": "model.reto1.staging_to_datawarehouse"} */
alter table "postgres"."public"."staging_to_datawarehouse" rename to "staging_to_datawarehouse__dbt_backup"
2022-02-21 23:58:18.388750 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-02-21 23:58:18.399079 (Thread-1): Using postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-21 23:58:18.402674 (Thread-1): On model.reto1.staging_to_datawarehouse: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "node_id": "model.reto1.staging_to_datawarehouse"} */
alter table "postgres"."public"."staging_to_datawarehouse__dbt_tmp" rename to "staging_to_datawarehouse"
2022-02-21 23:58:18.405713 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-02-21 23:58:18.431750 (Thread-1): On model.reto1.staging_to_datawarehouse: COMMIT
2022-02-21 23:58:18.433774 (Thread-1): Using postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-21 23:58:18.435784 (Thread-1): On model.reto1.staging_to_datawarehouse: COMMIT
2022-02-21 23:58:18.439527 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-02-21 23:58:18.452039 (Thread-1): Using postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-21 23:58:18.453800 (Thread-1): On model.reto1.staging_to_datawarehouse: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "node_id": "model.reto1.staging_to_datawarehouse"} */
drop table if exists "postgres"."public"."staging_to_datawarehouse__dbt_backup" cascade
2022-02-21 23:58:18.458577 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2022-02-21 23:58:18.464019 (Thread-1): finished collecting timing info
2022-02-21 23:58:18.466174 (Thread-1): On model.reto1.staging_to_datawarehouse: Close
2022-02-21 23:58:18.473851 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8099821b-d448-46ef-88b2-170971e2360e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3aca21b50>]}
2022-02-21 23:58:18.477026 (Thread-1): 23:58:18 | 1 of 1 OK created table model public.staging_to_datawarehouse........ [SELECT 0 in 0.30s]
2022-02-21 23:58:18.479763 (Thread-1): Finished running node model.reto1.staging_to_datawarehouse
2022-02-21 23:58:18.494103 (MainThread): Acquiring new postgres connection "master".
2022-02-21 23:58:18.495756 (MainThread): Using postgres connection "master".
2022-02-21 23:58:18.501192 (MainThread): On master: BEGIN
2022-02-21 23:58:18.507884 (MainThread): Opening a new connection, currently in state closed
2022-02-21 23:58:18.524620 (MainThread): SQL status: BEGIN in 0.02 seconds
2022-02-21 23:58:18.527232 (MainThread): On master: COMMIT
2022-02-21 23:58:18.529418 (MainThread): Using postgres connection "master".
2022-02-21 23:58:18.531693 (MainThread): On master: COMMIT
2022-02-21 23:58:18.534090 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-21 23:58:18.535978 (MainThread): On master: Close
2022-02-21 23:58:18.539120 (MainThread): 23:58:18 | 
2022-02-21 23:58:18.544563 (MainThread): 23:58:18 | Finished running 1 table model in 0.68s.
2022-02-21 23:58:18.548462 (MainThread): Connection 'master' was properly closed.
2022-02-21 23:58:18.550878 (MainThread): Connection 'model.reto1.staging_to_datawarehouse' was properly closed.
2022-02-21 23:58:18.574329 (MainThread): 
2022-02-21 23:58:18.579504 (MainThread): Completed successfully
2022-02-21 23:58:18.582418 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-02-21 23:58:18.586573 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3aca52950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3aca529d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3ad3660d0>]}
2022-02-21 23:58:18.590158 (MainThread): Flushing usage events
2022-02-22 00:00:12.688551 (MainThread): Running with dbt=0.21.1
2022-02-22 00:00:14.120140 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/opt/airflow/dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-02-22 00:00:14.147633 (MainThread): Tracking: tracking
2022-02-22 00:00:14.250326 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d7614750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d7606f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d7618a90>]}
2022-02-22 00:00:14.940698 (MainThread): Partial parsing not enabled
2022-02-22 00:00:15.098880 (MainThread): Parsing macros/relations.sql
2022-02-22 00:00:15.231952 (MainThread): Parsing macros/catalog.sql
2022-02-22 00:00:15.337269 (MainThread): Parsing macros/adapters.sql
2022-02-22 00:00:16.786081 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-02-22 00:00:16.934353 (MainThread): Parsing macros/core.sql
2022-02-22 00:00:17.303567 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-02-22 00:00:17.408714 (MainThread): Parsing macros/etc/datetime.sql
2022-02-22 00:00:17.747253 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-02-22 00:00:17.782722 (MainThread): Parsing macros/etc/is_incremental.sql
2022-02-22 00:00:17.849404 (MainThread): Parsing macros/etc/query.sql
2022-02-22 00:00:17.946975 (MainThread): Parsing macros/etc/where_subquery.sql
2022-02-22 00:00:18.026699 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-02-22 00:00:18.079851 (MainThread): Parsing macros/materializations/helpers.sql
2022-02-22 00:00:18.719379 (MainThread): Parsing macros/materializations/test.sql
2022-02-22 00:00:19.324632 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-02-22 00:00:20.743160 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-02-22 00:00:21.660826 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-02-22 00:00:21.710660 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-02-22 00:00:21.810341 (MainThread): Parsing macros/materializations/view/view.sql
2022-02-22 00:00:22.037933 (MainThread): Parsing macros/materializations/common/merge.sql
2022-02-22 00:00:22.248735 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-02-22 00:00:22.270335 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-02-22 00:00:23.804207 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-02-22 00:00:24.417770 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-02-22 00:00:24.797928 (MainThread): Parsing macros/materializations/table/table.sql
2022-02-22 00:00:24.903811 (MainThread): Parsing macros/adapters/common.sql
2022-02-22 00:00:26.079417 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-02-22 00:00:26.140554 (MainThread): Parsing macros/schema_tests/unique.sql
2022-02-22 00:00:26.175859 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-02-22 00:00:26.326742 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-02-22 00:00:28.746685 (MainThread): Acquiring new postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-22 00:00:29.113182 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0315d4da-82db-4ba5-9ce6-26f3506a46a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d74d0b50>]}
2022-02-22 00:00:29.135729 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-02-22 00:00:29.141901 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0315d4da-82db-4ba5-9ce6-26f3506a46a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d74d0bd0>]}
2022-02-22 00:00:29.145392 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 1 source, 0 exposures
2022-02-22 00:00:29.149992 (MainThread): 
2022-02-22 00:00:29.160636 (MainThread): Acquiring new postgres connection "master".
2022-02-22 00:00:29.187565 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-02-22 00:00:29.328682 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-02-22 00:00:29.348175 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-02-22 00:00:29.353527 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-02-22 00:00:29.400675 (ThreadPoolExecutor-0_0): SQL status: SELECT 5 in 0.05 seconds
2022-02-22 00:00:29.424204 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-02-22 00:00:29.446297 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-02-22 00:00:29.537160 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-22 00:00:29.549236 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-02-22 00:00:29.554399 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-02-22 00:00:29.621745 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.07 seconds
2022-02-22 00:00:29.627535 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-02-22 00:00:29.632006 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-02-22 00:00:29.648542 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.01 seconds
2022-02-22 00:00:29.653022 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-02-22 00:00:29.675011 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-02-22 00:00:29.698802 (MainThread): Using postgres connection "master".
2022-02-22 00:00:29.707603 (MainThread): On master: BEGIN
2022-02-22 00:00:29.712312 (MainThread): Opening a new connection, currently in state init
2022-02-22 00:00:29.804814 (MainThread): SQL status: BEGIN in 0.09 seconds
2022-02-22 00:00:29.807860 (MainThread): Using postgres connection "master".
2022-02-22 00:00:29.810124 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-02-22 00:00:29.829333 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2022-02-22 00:00:29.847663 (MainThread): On master: ROLLBACK
2022-02-22 00:00:29.855309 (MainThread): Using postgres connection "master".
2022-02-22 00:00:29.868590 (MainThread): On master: BEGIN
2022-02-22 00:00:29.884935 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-02-22 00:00:29.887201 (MainThread): On master: COMMIT
2022-02-22 00:00:29.889376 (MainThread): Using postgres connection "master".
2022-02-22 00:00:29.892366 (MainThread): On master: COMMIT
2022-02-22 00:00:29.903762 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-22 00:00:29.907564 (MainThread): On master: Close
2022-02-22 00:00:29.914022 (MainThread): 00:00:29 | Concurrency: 1 threads (target='dw')
2022-02-22 00:00:29.970210 (MainThread): 00:00:29 | 
2022-02-22 00:00:30.064403 (Thread-1): Began running node model.reto1.staging_to_datawarehouse
2022-02-22 00:00:30.068182 (Thread-1): 00:00:30 | 1 of 1 START table model public.staging_to_datawarehouse............. [RUN]
2022-02-22 00:00:30.072388 (Thread-1): Acquiring new postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-22 00:00:30.075864 (Thread-1): Compiling model.reto1.staging_to_datawarehouse
2022-02-22 00:00:30.125261 (Thread-1): Writing injected SQL for node "model.reto1.staging_to_datawarehouse"
2022-02-22 00:00:30.152410 (Thread-1): finished collecting timing info
2022-02-22 00:00:30.306895 (Thread-1): Writing runtime SQL for node "model.reto1.staging_to_datawarehouse"
2022-02-22 00:00:30.314369 (Thread-1): Using postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-22 00:00:30.316988 (Thread-1): On model.reto1.staging_to_datawarehouse: BEGIN
2022-02-22 00:00:30.320237 (Thread-1): Opening a new connection, currently in state closed
2022-02-22 00:00:30.346266 (Thread-1): SQL status: BEGIN in 0.03 seconds
2022-02-22 00:00:30.348874 (Thread-1): Using postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-22 00:00:30.351346 (Thread-1): On model.reto1.staging_to_datawarehouse: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "node_id": "model.reto1.staging_to_datawarehouse"} */


  create  table "postgres"."public"."staging_to_datawarehouse__dbt_tmp"
  as (
    

with source_table as 
(
    select * from "postgres"."staging_schema"."users"
),

final as
(
    select * from source_table
)

select * from final
  );
2022-02-22 00:00:30.363096 (Thread-1): SQL status: SELECT 0 in 0.01 seconds
2022-02-22 00:00:30.401992 (Thread-1): Using postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-22 00:00:30.414629 (Thread-1): On model.reto1.staging_to_datawarehouse: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "node_id": "model.reto1.staging_to_datawarehouse"} */
alter table "postgres"."public"."staging_to_datawarehouse" rename to "staging_to_datawarehouse__dbt_backup"
2022-02-22 00:00:30.421779 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-02-22 00:00:30.438268 (Thread-1): Using postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-22 00:00:30.445337 (Thread-1): On model.reto1.staging_to_datawarehouse: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "node_id": "model.reto1.staging_to_datawarehouse"} */
alter table "postgres"."public"."staging_to_datawarehouse__dbt_tmp" rename to "staging_to_datawarehouse"
2022-02-22 00:00:30.453970 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-02-22 00:00:30.557175 (Thread-1): On model.reto1.staging_to_datawarehouse: COMMIT
2022-02-22 00:00:30.568220 (Thread-1): Using postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-22 00:00:30.571406 (Thread-1): On model.reto1.staging_to_datawarehouse: COMMIT
2022-02-22 00:00:30.579659 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-02-22 00:00:30.617761 (Thread-1): Using postgres connection "model.reto1.staging_to_datawarehouse".
2022-02-22 00:00:30.625605 (Thread-1): On model.reto1.staging_to_datawarehouse: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "postgres", "target_name": "dw", "node_id": "model.reto1.staging_to_datawarehouse"} */
drop table if exists "postgres"."public"."staging_to_datawarehouse__dbt_backup" cascade
2022-02-22 00:00:30.634282 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2022-02-22 00:00:30.641551 (Thread-1): finished collecting timing info
2022-02-22 00:00:30.648125 (Thread-1): On model.reto1.staging_to_datawarehouse: Close
2022-02-22 00:00:30.655469 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0315d4da-82db-4ba5-9ce6-26f3506a46a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d74e3e50>]}
2022-02-22 00:00:30.663124 (Thread-1): 00:00:30 | 1 of 1 OK created table model public.staging_to_datawarehouse........ [SELECT 0 in 0.58s]
2022-02-22 00:00:30.666375 (Thread-1): Finished running node model.reto1.staging_to_datawarehouse
2022-02-22 00:00:30.766272 (MainThread): Acquiring new postgres connection "master".
2022-02-22 00:00:30.772575 (MainThread): Using postgres connection "master".
2022-02-22 00:00:30.779014 (MainThread): On master: BEGIN
2022-02-22 00:00:30.782182 (MainThread): Opening a new connection, currently in state closed
2022-02-22 00:00:30.814555 (MainThread): SQL status: BEGIN in 0.03 seconds
2022-02-22 00:00:30.819165 (MainThread): On master: COMMIT
2022-02-22 00:00:30.830033 (MainThread): Using postgres connection "master".
2022-02-22 00:00:30.833691 (MainThread): On master: COMMIT
2022-02-22 00:00:30.838783 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-02-22 00:00:30.847999 (MainThread): On master: Close
2022-02-22 00:00:30.857781 (MainThread): 00:00:30 | 
2022-02-22 00:00:30.900777 (MainThread): 00:00:30 | Finished running 1 table model in 1.70s.
2022-02-22 00:00:30.913815 (MainThread): Connection 'master' was properly closed.
2022-02-22 00:00:30.919365 (MainThread): Connection 'model.reto1.staging_to_datawarehouse' was properly closed.
2022-02-22 00:00:31.017194 (MainThread): 
2022-02-22 00:00:31.023391 (MainThread): Completed successfully
2022-02-22 00:00:31.035410 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-02-22 00:00:31.050604 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d7554a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d74cbed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9d7468a90>]}
2022-02-22 00:00:31.059982 (MainThread): Flushing usage events
